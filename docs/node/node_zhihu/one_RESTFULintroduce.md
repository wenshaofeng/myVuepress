# REST和它的6个限制

## REST是什么

如果有人问你`REST`是什么？ 
你可以言简意赅的回答：<font color=#3eaf7c>`REST`是一种风格，是万维网软件架构的风格</font>.

如果有人问你`REST`是用来干什么的？ 
这种风格是万维网软件架构风格，<font color=#3eaf7c>它必然是用来架构万维网软件的，用来创建网络服务</font>.

如果有人问你这种风格为什么叫`REST`？
`REST`的全称是`(Resource)Representational State Transfer`
+ 单词`Resource`在这里虽然没有表现，但确实最重要的。任何能被命名的信息都能作为一个资源，我们抽象出来的资源都应该是可标识的，都应该拥有一个明显的`ID`——在`Web`中，代表`ID`的统一概念是：`URI`（统一资源标识符）
+ 其中`Representational`字面意思是： <font color=#3eaf7c>表述是一段对于资源在某个特定时刻的状态的描述，描述形式有JSON,XML等等</font>，虽然`REST`对数据传输的格式并没有做限制，但是最佳实践中还是`json`这种媒体类型用的最多
+ 其中`State`表示当前的状态或者数据，因为数据在变化的每个阶段都是一种状态，所以用状态来描述数据显示了数据是会变化的，会修改的
+ 其中`Transfer`表示数据传输，但是客户端和服务端之间传送的是 <font color=#3eaf7c>资源的表述</font> ，而不是资源本身，客户端和服务器端之间转移（transfer）代表资源状态的表述。通过转移和操作资源的表述，来间接实现操作资源的目的。

所以我们将`REST`称为<font color=#3eaf7c>资源表述性状态转移</font>,通俗的讲就是：<font color=#3eaf7c>资源在网络中以某种表现形式进行状态转移</font> 

## REST的6个限制

### 1. 客户-服务器

客户-服务器（Client-Server）也叫作`CS`架构，这个是非常常见了，现在几乎没有什么不是`CS`架构了，这个限制的本质是一种软件架构思想叫做 <font color=#3eaf7c>关注点分离</font>，通俗的说就是<font color=#3eaf7c>各扫门前雪，自己管好自己的事</font>

+ 服务端专注数据存储，提升了简单性: 之前的服务端要渲染页面还要存储数据，现在只用数据存储，从而代码也变得更加简单
+ 前端专注用户界面，提升了可移植性: 现在前端只用调用接口渲染界面，而现在这种功能很多平台都支持，所以可移植性提升了

### 2. 无状态

无状态（Stateless）指的是 <font color=#3eaf7c>所有用户会话信息都保存在客户端</font>,所有的会话信息服务端是不管的，服务端不会知道当前用户的状态

所以<font color=#3eaf7c>每次请求必须包括所有信息，不能依赖上下文信息</font>: 比如说你在看一本小说，要看下一页，你必须告诉服务端下一页的页码数是几，不能告诉服务端我要看下一页，因为服务端不知道你当前在第几页，它不知道你当前的状态，无法判断。

这样的好处是服务端不会保存会话信息，提升了简单性，可靠性，可见性
+ 服务端不用管理会话信息，就少了一大部分代码，提升了简单性
+ 可靠性指的是软件的稳定程度和从一次故障中恢复正常的能力，如果服务端管理会话信息，一旦出错，会话信息就会完全丢失，恢复起来极其困难
+ 可见性指的是模块和接口的透明程度，因为每次请求都会包含所有信息，所以接口更加透明

### 3. 缓存
缓存（Cache）的具体意思是：<font color=#3eaf7c>所有服务端的相应都要被标位可缓存或者不可缓存</font>

缓存的作用就是 <font color=#3eaf7c>减少了前后端交互，提升了性能</font>。比如`js`文件，`css`文件等静态资源，这些东西缓存在客户端即可，不要每次都想服务端请求

### 4. 统一接口
统一接口（Uniform interface）这个限制是最重要的一个，因为像`cs`架构或者缓存，别的风格也会用，但是只有统一接口最能表现`REST`的特点

+ <font color=#3eaf7c>统一</font>：接口设计尽可能统一通用，提升了简单性，可见性
+ <font color=#3eaf7c>接口</font>：接口与实现解耦，使前后端可以独立开发迭代

### 5. 分层系统
分层系统（layered System）指的是软件架构分很多系统，<font color=#3eaf7c>每层只知道相邻的一层，后面隐藏的就不知道了</font>，比如说：客户端不知道是和代理还是真实的服务器通信

分层系统还有其他层: 
+ 安全层（专门负责错误处理）
+ 负载均衡（流量多，负载强，管理流量分发）
+ 缓存层等（静态资源缓存）

我们在后面会介绍很多中间件来说明这些不同层级

### 6. 按需代码
按需代码（code-on-demand）这个是可选的，也不是很重要

客户端可以下载运行服务端传来的代码（比如JS）。通过减少了一些功能，简化了客户端

## 统一接口的具体限制
统一接口是上面我们讲的6个限制之一，表明接口要尽可能设计的统一，那么问题来了，被设计统一的接口长什么样子？我们下面就要去说。

### 1. 资源的标识
资源是任何可以命名的事物，比如用户，评论等，每个资源可以通过URI（统一资源标识符）被唯一的标识

比如要访问`github`用户列表的资源，我们只能去访问下面这样的`URL`
```bash
https://api.github.com/users
https://api.github.com/users/lewis617
```

### 2. 通过表述来操作资源
表述就是`Representation`,比如`JSON`,`XML`等等，通过表述来操作资源意思就是：<font color=#3eaf7c>客户端不能直接操作（比如SQL）服务端资源，客户端应该通过表述（比如JSON）来操作资源</font>。

### 3. 自描述信息
每个信息（请求或者响应）必须提供足够的信息让接受者理解，这个消息指的就是请求或者响应携带的数据,具体指：
+ 媒体类型（`application/json`, `applicaiton/xml`）
+ http方法：`GET`,`POST`,`DELETE`
+ 是否缓存：`Cache-Control`

### 4. 超媒体作为应用状态引擎
超媒体作为应用状态引擎这个虽然听起来很难，但是我们来解释一下这些词汇：
+ 超媒体：带文字的连接
+ 应用状态：一个网页
+ 引擎：驱动跳转

所以超媒体作为应用状态引擎通俗的讲就是：点击链接跳转到另一个网页




**参考资料**

1. [REST 学习 1 - 推导 REST](https://juejin.im/entry/57f8a128da2f60004f8b0ca6)
2. [理解本质的 REST](https://juejin.im/entry/59dc8771f265da430d56f8e4)
3. [[译] REST API 已死，GraphQL 长存](https://juejin.im/post/5991667b518825485d28dfb1)